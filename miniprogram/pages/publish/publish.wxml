<view class="container" style="padding-top: {{paddingTop}}px">
  <view class="page-title">å‘å¸ƒæ‰¾èˆå‹</view>
  <view class="card">
    <view class="row click" bindtap="chooseLocation">
      <text class="lbl">å°åŒºåœ°ç‚¹</text>
      <text class="val">{{formData.community || 'ç‚¹å‡»é€‰æ‹©'}}</text>
    </view>
    <view class="row">
      <text class="lbl">æˆ·å‹</text>
      <view class="flex">
        <input class="s-in" type="number" placeholder="3" bindinput="onRoomCountInput" /> å®¤
        <input class="s-in" type="number" placeholder="1" bindinput="bindInput" data-path="formData.layout.hall"/> å…
        <input class="s-in" type="number" placeholder="1" bindinput="bindInput" data-path="formData.layout.toilet"/> å«
      </view>
    </view>
    <view class="row">
      <text class="lbl">æ€»ç§Ÿé‡‘</text>
      <input class="val" style="text-align:right" type="digit" placeholder="0" bindinput="bindInput" data-path="formData.totalPrice"/>
    </view>
  </view>

  <block wx:for="{{formData.rooms}}" wx:key="index">
    <view class="card room-card {{item.status==1?'occ':''}}">
      <view class="r-head">
        <text class="badge">æˆ¿é—´ {{index+1}}</text>
        <view class="sw-box">
          <text>{{item.status==1?'å·²å…¥ä½':'æ‹›å‹Ÿä¸­'}}</text>
          <switch scale="0.7" color="#FF2442" checked="{{item.status==1}}" bindchange="toggleRoomStatus" data-idx="{{index}}"/>
        </view>
      </view>

      <view class="r-body">
        <view class="flex mb">
          <input class="m-in" placeholder="åç§°(ä¸»å§)" value="{{item.name}}" bindinput="updateRoomField" data-idx="{{index}}" data-field="name"/>
          <input class="m-in" placeholder="é¢ç§¯ã¡" type="digit" value="{{item.area}}" bindinput="updateRoomField" data-idx="{{index}}" data-field="area"/>
          <view class="ensuite" bindtap="toggleEnsuite">
             <text>ç‹¬å«</text>
             <switch scale="0.6" checked="{{item.hasEnsuite}}" bindchange="toggleEnsuite" data-idx="{{index}}"/>
          </view>
        </view>

        <!-- çŠ¶æ€ï¼šå·²å…¥ä½ -->
        <view wx:if="{{item.status==1}}" class="sec-box">
           <view class="p-row">
             <text>æ˜¯å¦æœ¬äººå…¥ä½</text>
             <picker range="{{isMeOptions}}" value="{{item.isMeIndex}}" bindchange="onIsMeChange" data-idx="{{index}}">
               <view class="pk-val">{{isMeOptions[item.isMeIndex]}} â–¾</view>
             </picker>
           </view>
           <!-- å¦ï¼šå¡«è¯¦æƒ… -->
           <view wx:if="{{item.isMeIndex==1}}" class="sub-form">
             <picker range="{{genderOptions}}" value="{{item.occupant.genderIndex}}" bindchange="onOccGenderChange" data-idx="{{index}}">
                <view class="pk-box">æ€§åˆ«: {{genderOptions[item.occupant.genderIndex]}} â–¾</view>
             </picker>
             <picker range="{{ageOptions}}" value="{{item.occupant.ageIndex}}" bindchange="onOccAgeChange" data-idx="{{index}}">
                <view class="pk-box">å¹´é¾„: {{ageOptions[item.occupant.ageIndex]}} â–¾</view>
             </picker>
             <input class="pk-box input" placeholder="èŒä¸š" value="{{item.occupant.job}}" bindinput="updateRoomField" data-idx="{{index}}" data-field="occupant.job"/>
           </view>
        </view>

        <!-- çŠ¶æ€ï¼šæ‹›å‹Ÿä¸­ -->
        <view wx:if="{{item.status==0}}" class="sec-box">
           <view class="flex mb">
              <text>ç§Ÿé‡‘</text>
              <input class="m-in red" type="digit" placeholder="2000" value="{{item.price}}" bindinput="updateRoomField" data-idx="{{index}}" data-field="price"/>
           </view>
           <view class="flex">
              <text>æœŸæœ›æ€§åˆ«</text>
              <picker range="{{expectGenderOptions}}" value="{{item.expectGender}}" bindchange="onExpectGenderChange" data-idx="{{index}}">
                 <view class="pk-val">{{expectGenderOptions[item.expectGender]}} â–¾</view>
              </picker>
           </view>
        </view>

        <view class="photo-upload" bindtap="uploadRoomPhoto" data-idx="{{index}}">
           <image wx:if="{{item.photos[0]}}" src="{{item.photos[0]}}" mode="aspectFill" class="pv-img"></image>
           <view wx:else class="tip">ğŸ“· æˆ¿é—´ç…§ç‰‡(3:4)</view>
        </view>
      </view>
    </view>
  </block>

  <view style="height:200rpx"></view>
  <button class="pub-btn" bindtap="submit">å‘å¸ƒ</button>
</view>