<view class="container">
  <view class="login-card">
    <view class="header">
      <view class="h1">欢迎来到友邻</view>
      <view class="h2">完善信息，遇见合拍室友</view>
    </view>

    <button class="avatar-wrapper" open-type="chooseAvatar" bindchooseavatar="onChooseAvatar">
      <image class="avatar" src="{{userInfo.avatarUrl || ''}}"></image>
      <view class="cam-icon" wx:if="{{!userInfo.avatarUrl}}">📷</view>
    </button>

    <view class="form-box">
      <view class="input-group">
        <view class="label">昵称 <text class="required">*</text></view>
        <input type="nickname" class="input" placeholder="请输入昵称" bindchange="onNickNameChange"/>
      </view>

      <view class="input-group">
        <view class="label">职业 <text class="required">*</text></view>
        <input class="input" placeholder="例如：产品经理" bindinput="bindInput" data-key="job"/>
      </view>

      <view class="input-group">
        <view class="label">年龄 <text class="required">*</text></view>
        <picker range="{{ageOptions}}" bindchange="onAgeChange">
          <view class="input picker-view {{userInfo.ageIndex!=null?'':'ph'}}">
            {{userInfo.ageIndex != null ? ageOptions[userInfo.ageIndex] : '请选择年龄'}}
          </view>
        </picker>
      </view>

      <view class="gender-row">
        <view class="g-btn {{userInfo.gender==1?'active-m':''}}" bindtap="setGender" data-v="1">♂ 男生</view>
        <view class="g-btn {{userInfo.gender==2?'active-f':''}}" bindtap="setGender" data-v="2">♀ 女生</view>
      </view>

      <view class="tags-section">
        <view class="label">个人标签 <text class="required">*</text> <text style="font-size:22rpx;color:#999;font-weight:normal">(最多选4个)</text></view>
        <view class="tags-list">
          <block wx:for="{{tagOptions}}" wx:key="*this">
            <view class="tag {{tags[item]?'selected':''}}" bindtap="toggleTag" data-tag="{{item}}">{{item}}</view>
          </block>
          <block wx:for="{{extraTags}}" wx:key="*this">
            <view class="tag {{tags[item]?'selected':''}}" bindtap="toggleTag" data-tag="{{item}}">{{item}}</view>
          </block>
        </view>
        <view class="custom-tag-row">
           <!-- 移除了 maxlength="6" -->
           <input class="c-input" placeholder="自定义标签" value="{{inputTagVal}}" bindinput="onTagInput"/>
           <view class="add-btn" bindtap="addCustomTag">+</view>
        </view>
      </view>
    </view>

    <button class="submit-btn" bindtap="submit">进入友邻</button>
  </view>
</view>